var M=Object.defineProperty,j=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var l=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var h=(e,t,s)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,m=(e,t)=>{for(var s in t||(t={}))S.call(t,s)&&h(e,s,t[s]);if(l)for(var s of l(t))b.call(t,s)&&h(e,s,t[s]);return e},f=(e,t)=>j(e,D(t));import{e as P,g as $,d as w,l as x,f as z,h as g}from"./hoc.e4b6067d.js";import{j as i,a as A}from"./index.ef2f8849.js";import"https://wizui-assets.oss-cn-hangzhou.aliyuncs.com/umd/arco.min.js";import"./vendor.1045acf8.js";import"https://unpkg.com/react-dnd@14.0.5/dist/umd/ReactDnD.min.js";import"https://unpkg.com/react-dnd-html5-backend@14.0.2/dist/umd/ReactDnDHTML5Backend.min.js";import"https://unpkg.com/@arco-design/web-react@2.55.0/dist/arco.min.js";import"https://unpkg.com/@arco-design/web-react@2.55.0/dist/arco-icon.min.js";function a(e,t,s){return t=E(t),t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function E(e){var t=O(e,"string");return typeof t=="symbol"?t:String(t)}function O(e,t){if(typeof e!="object"||e===null)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var o=s.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class k{constructor(){a(this,"routes",[]),a(this,"pageMap",void 0),a(this,"fileMap",void 0),a(this,"history",void 0),a(this,"setRoutes",t=>{if(Array.isArray(t)){const s=P(t);this.routes=$(s,(o,n)=>{const{paths:r}=n||{};return f(m({},o),{paths:`${r?`${r}/`:"/"}${o.path}`})})}}),a(this,"getPageComponent",async t=>{const s=this.pageMap[t],o=await this.fileMap[s](),n=`createPage_${t.replace("-","")}`;return{default:o[n](w)}}),a(this,"init",async t=>{await x(t);const o=window.LowCodeRenderer(w),{menus:n,pageMap:r,fileMap:v,modules:p}=o;if(this.setRoutes(n),this.pageMap=r,this.fileMap=v,p)for(const d in p)z.mModules[d]=p[d]();console.log("appData-date",this,o.date)})}}var c=new k;const C=window.React.lazy,H=window.React.useEffect,u=window.React.useMemo,I=window.React.useState,T=window.ReactRouterDOM.HashRouter,_=window.ReactRouterDOM.Switch,R=window.ReactRouterDOM.Route,K=window.ReactRouterDOM.Redirect,L=window.ReactRouterDOM.useHistory,B=localStorage.getItem("tenant");let y="https://wizui-assets.oss-cn-hangzhou.aliyuncs.com/resource/"+B;g.loadCSS(`${y}/app.css`);function F(e){const t=[];function s(o){o.forEach(n=>{Array.isArray(n.children)&&n.children.length&&s(n.children),n.pageId&&n.isActive==1&&(c.pageMap[n.pageId]?n.component=C(()=>c.getPageComponent(n.pageId)):n.component=()=>i("span",{}),t.push(n))})}return s(e),t}const N=()=>{const e=u(()=>F(c.routes),[]);g.history=L();const t=u(()=>e.length?e[0].paths:"/",[e]),s=u(()=>e.map((o,n)=>i(R,{path:o.paths,component:o.component},n)),[e]);return A(_,{children:[s,i(R,{exact:!0,path:"/",children:i(K,{to:t})})]})};var Z=()=>{const[e,t]=I(!1);return H(()=>{c.init(`${y}/app.js?t=${Date.now()}`).then(()=>{t(!0)})},[]),e?i(T,{basename:"/run",children:i(N,{})}):null};export{Z as default};
