var q=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var F=(e,n,t)=>n in e?q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,l=(e,n)=>{for(var t in n||(n={}))C.call(n,t)&&F(e,t,n[t]);if(v)for(var t of v(n))P.call(n,t)&&F(e,t,n[t]);return e},p=(e,n)=>Y(e,Z(n));var S=(e,n)=>{var t={};for(var a in e)C.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(e!=null&&v)for(var a of v(e))n.indexOf(a)<0&&P.call(e,a)&&(t[a]=e[a]);return t};import{q as Q,r as W,s as R,t as X,u as k,F as ee,v as te,a as T,T as ne,b as oe,w as M,x as z,y as ae,z as re,B as se,D as ie,G as ce,H as ue,J as O,K as le,L as de,N as me,E as fe,m as D,O as pe,P as be}from"./index.262ad20e.js";import"./vendor.96977194.js";import{b as we,a as _,U as he,Y as ye,h as B,O as ge,Z as ve}from"./hoc.bd850057.js";import{j as c,a as N,F as Ie}from"./index.0420ae1d.js";import"./index.9a4254e7.js";import"./p9dlhpru.1263e167.js";import"https://static-s.gaiaworkforce.com/formPlatForm/umdjs/monaco/index.min.js";import"https://wizui-assets.oss-cn-hangzhou.aliyuncs.com/umd/arco.min.js";import"https://unpkg.com/react-dnd@14.0.5/dist/umd/ReactDnD.min.js";import"https://unpkg.com/react-dnd-html5-backend@14.0.2/dist/umd/ReactDnDHTML5Backend.min.js";import"https://unpkg.com/@arco-design/web-react@2.55.0/dist/arco.min.js";import"https://unpkg.com/@arco-design/web-react@2.55.0/dist/arco-icon.min.js";var je=e=>c(Q,l({placeholder:"\u8BF7\u8F93\u5165",autoComplete:"off"},e));const xe=e=>we.post("/apijson/get",{"Module[]":{count:0,Module:{"id{}":e,platform:_.platform,deletedTime:0,appId:_.appId,"@column":"id,moduleId,name,imgUrl,nickname,description,deletedTime,category,display,content,extraInfo,jsxRender,platform,price,manufacturer,props,source"}}}).then(n=>{const t=n.Module.map(W);for(const a of t)a.source=="custom"&&a.extraInfo&&a.extraInfo.cssStr&&he(a.extraInfo.cssStr,a.moduleId);return t});function K(e,n,t){return n=Se(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Se(e){var n=ke(e,"string");return typeof n=="symbol"?n:String(n)}function ke(e,n){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var a=t.call(e,n||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}class Ee{constructor(){K(this,"value",[]),K(this,"setValue",n=>{this.value=n})}}const Ce=window.React.useEffect,Pe=window.React.useMemo,L=window.React.useState,Fe=window.arco.Table,Re=window.arco.Checkbox,Te=window.arco.InputNumber,I=window.arco.Button,Me=window.arco.Input,ze=window.arco.Space,Oe=window.arcoicon.IconArrowDown,De=window.arcoicon.IconArrowUp,_e=window.arcoicon.IconDelete,Be=window.arcoicon.IconPlus,Ne=a=>{var d=a,{notOperation:e,notAdd:n}=d,t=S(d,["notOperation","notAdd"]);const[o]=L(()=>typeof t.rowKey=="string"?t.rowKey:"id"),[r]=L(()=>new Ee),x=t.value||[];Ce(()=>{Array.isArray(t.value)&&!Object.is(r.value,t.value)?r.setValue(t.value.map(b=>l({[o]:Math.random().toString(32).slice(2)},b))):r.setValue([])},[t.value]);const g=b=>{const i=t.columns.find(s=>s.valueType==="index"||s.valueType==="letter"),m=b.map((s,u)=>i?p(l({},s),{[i.dataIndex]:i.valueType==="index"?u:ye[u]}):l({},s));t.value||r.setValue(m),t.onChange&&t.onChange(m)},h=(b,i)=>{const m=[...r.value];m[b]=i,g(m)},H=Pe(()=>{if(!t.columns)return[];const b=[...t.columns.map((i,m)=>(!i.render&&i.valueType!=="text"&&(i.render=(s,u,y)=>{switch(i.valueType){case"index":case"letter":return s;case"any":return c(X,{value:s,onChange:f=>h(y,p(l({},u),{[i.dataIndex]:f}))},u[o]);case"checkout":return c(Re,{checked:s,onChange:f=>h(y,p(l({},u),{[i.dataIndex]:f}))},u[o]);case"number":return c(Te,{placeholder:"\u8BF7\u8F93\u5165",value:s,onChange:f=>h(y,p(l({},u),{[i.dataIndex]:f}))},u[o]);case"color":return c(R,{value:s,onChange:f=>{h(y,p(l({},u),{[i.dataIndex]:f}))}},u[o]);default:return c(Me,{placeholder:"\u8BF7\u8F93\u5165",value:s,onChange:f=>h(y,p(l({},u),{[i.dataIndex]:f}))},u[o])}}),i))];return e||b.push({title:"\u64CD\u4F5C",dataIndex:o,width:60,render:(i,m,s)=>N(ze,{size:"mini",children:[c(I,{size:"mini",shape:"circle",status:"danger",type:"primary",icon:c(_e,{}),onClick:()=>{g(r.value.filter(u=>u[o]!==m[o]))}}),Boolean(s)?c(I,{size:"mini",shape:"circle",type:"primary",icon:c(De,{}),onClick:()=>{r.value.splice(s,1),r.value.splice(s-1,0,m),g([...r.value])}}):c(I,{size:"mini",shape:"circle",type:"primary",icon:c(Oe,{}),onClick:()=>{r.value.splice(s,1),r.value.splice(s+1,0,m),g([...r.value])}})]})}),b},[t.columns]);return N(Ie,{children:[c(Fe,p(l({className:"editor-table",pagination:!1,rowKey:o},t),{data:x,onChange:void 0,columns:H})),!n&&c(I,{type:"outline",style:{width:"100%",marginTop:8},icon:c(Be,{}),onClick:()=>h(r.value.length,{[o]:Math.random().toString(32).slice(2)}),children:"\u6DFB\u52A0"})]})};var w,V,$;function A(e,n,t,a){!t||Object.defineProperty(e,n,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(a):void 0})}function U(e,n,t){return n=Ke(n),n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Ke(e){var n=Le(e,"string");return typeof n=="symbol"?n:String(n)}function Le(e,n){if(typeof e!="object"||e===null)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var a=t.call(e,n||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function E(e,n,t,a,d){var o={};return Object.keys(a).forEach(function(r){o[r]=a[r]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=t.slice().reverse().reduce(function(r,x){return x(e,n,r)||r},o),d&&o.initializer!==void 0&&(o.value=o.initializer?o.initializer.call(d):void 0,o.initializer=void 0),o.initializer===void 0&&(Object.defineProperty(e,n,o),o=null),o}const Ve=window.mobx.action,$e=window.mobx.observable,Ae=window.mobx.computed,Ue=window.mobx.toJS;let Je=(w=class{constructor(){A(this,"values",V,this),A(this,"setValues",$,this),U(this,"init",async n=>{const{tableId:t,modelKey:a,itemId:d}=n;if(k.info[t]){this.setValues(p(l({},k.info[t]),{modelKey:a,itemId:d}));return}const o=await B.ajax.get("/custom/table/fields",{customTableInfoId:t}),r=await B.ajax.get("/custom/relation/itemTable",{tableId:t});k.setInfo(t,{fields:o,tables:r}),this.setValues({fields:o,tables:r,modelKey:a,itemId:d})}),U(this,"unInit",()=>{this.setValues({})})}get businessObj(){return Ue(this.values)}},V=E(w.prototype,"values",[$e],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),$=E(w.prototype,"setValues",[Ve],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.values=e}}}),E(w.prototype,"businessObj",[Ae],Object.getOwnPropertyDescriptor(w.prototype,"businessObj"),w.prototype),w);const Ge=window.React.useEffect,J=window.React.useState,He=window.mobxReactLite.useObserver;var qe=({value:e,children:n})=>{const[t]=J(()=>new Je),[a]=J(()=>ReactGtssForm.config.state.contexts.system_business);return Ge(()=>{const{tableId:d,modelKey:o}=e||{};d?t.init(e):t.unInit()},[e==null?void 0:e.tableId]),He(()=>c(a.Provider,{value:e,children:c(ee.Provider,{value:t.businessObj,children:n})}))};const j=window.React,G=window.React.createElement,Ye=window.arco.Switch;te({typescriptURL:"https://static-s.gaiaworkforce.com/formPlatForm/umdjs/typescript.min.js",lessURL:"https://static-s.gaiaworkforce.com/formPlatForm/umdjs/less.min.js",schema:{formats:{boolean:e=>G(Ye,l({checked:e.value},e)),selector:T,treeSelector:ne,featch:oe,lookup:e=>G(T,l({type:"lookup"},e)),icon:M,iconText:M,function:z,js:z,field:ae,itemTable:re,style:se,class:ie,color:R,nodeInput:je,editorTable:Ne,jsonSchema:ce,json:ue,jsonList:O,object:O.JSONEdit,schema:le,node:de,functionNode:me,modelKey:fe},sources:{featch:{funName:"featchData"}},pageInjectedVars:["forms"]},modules:{getRender:e=>{const n=ReactGtssForm.config,{key:t,source:a,name:d}=e;let o=()=>null;switch(a){case"arco":o=n.state.mModules[t]||(()=>t);break;case"custom":e.jsxRender&&(o=ge(e.jsxRender)),n.state.mModules[e.key]=o;break;case"system":o=n.state.mModules[e.key];break;case"context":n.state.contexts[e.key]||(n.state.contexts[e.key]=j.createContext(e.extraInfo.defaultProps)),e.key==="system_business"?o=qe:o=n.state.contexts[e.key].Provider,n.state.mModules[e.key]=o;break}return o&&o.preload&&o.preload(),o},getIcon:e=>j.createElement(ve,{value:e,key:e})},api:{getModuleList:xe},dependencies:{pandora:"pandora",arco:"arco-design/web-react"},run:ReactGtssForm.config});D.setElements(pe);be.forEach(e=>{D.elements.set(e.key,l({render:n=>{const d=n,{children:t}=d,a=S(d,["children"]);return j.createElement(e.key,a,...j.Children.toArray(t))}},e))});
